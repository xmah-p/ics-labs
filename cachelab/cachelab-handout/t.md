

```bash
make clean; make    # compile csim.c and trans.c

# run "ls -l", captures a trace of each of its memory accesses in occurring order
valgrind --log-fd=1 --tool=lackey -v --trace-mem=yes ls -l
```

# Part A

```bash
./csim-ref -v -s 4 -E 1 -b 4 -t traces/dave.trace

make; ./test-csim
```

忽视所有指令缓存访问: 以 `I` 开头的行
内存访问被完美对齐, 不会越界: 忽视 size

debug on small traces: `traces/dave.trace`

S/L: 至多一个 miss
M: 2 hits / 1 miss + 1 hit (+ 1 eviction)



# Part B

```bash
python3 driver.py

make; ./test-trans -M 32 -N 32

make; ./tracegen; ./csim-ref -v -s 5 -E 1 -b 5 -t trace.f0 > sim.f0
```

每个转置函数至多 12 个本地变量

禁止数组或 `malloc`

矩阵 B 和 A 有相同的组索引! 所以对角线会发生 conflict miss

最后一道题可以考虑56*64 和“L”字型分别处理，看之前的树洞2892761的说法说不定也有效 但前者已经足够满分了（如果有人不幸刷到这条洞的话）

[Bob] 直接行列换一下试试 有惊喜（）


cachelab
32×32的优化
8×8分块+局部变量存储可得满分

64×64的优化
4×4展开+细节处理可得5分左右
要想得剩下三分，需分情况处理脱靶情况

60×68的优化
不强求得满分，可以直接用16×4的分块，可以得97%或98%的分数，大概9.7分

若不想花太长时间，可采用本洞所说简单方法，分数可达50

如果第二个想卷满分，可以采用移块的方法，用B中暂且不用的块存储A中的数据，再进行移位
#19211412 11月前 2022-11-07 15:29
[Eve] 第三个，24*4直接过
#19211533 11月前 2022-11-07 15:35
[Eve] Re Eve: 搞错了，好像不能。还是要自己慢慢调

ics cachelab partB 的60 ×68咋做呀
xk 信科 cseeai
#19196933 11月前 2022-11-06 21:12
[洞主] dz只会八乘八达到1757 的miss，有没有巨佬给点提示，这种每一个row的cache line交错的怎么办呀
#19196952 11月前 2022-11-06 21:13
[洞主] 就离谱，我这上面一句话里有个关键词，倒腾5min愣是发布出来
#19196979 11月前 2022-11-06 21:14
[洞主] 还是敏感度不够，居然没有一眼发现这是敏感词，md，老老实实问问题被这玩意gank了一下呜呜呜
#19197020 11月前 2022-11-06 21:16
[洞主] Re 洞主: 发不出来*
#19197823 11月前 2022-11-06 21:55
[Alice] 𝟼𝟺
#19198364 11月前 2022-11-06 22:15
[Bob] 64
#19199669 11月前 2022-11-06 23:07
[Carol] 8*4
#19209815 11月前 2022-11-07 13:48
[Dave] 64
#19210014 11月前 2022-11-07 14:00
[Eve] Re Dave: 64是啥意思呀？
#19210064 11月前 2022-11-07 14:03
[Francis] 4289597
#19210071 11月前 2022-11-07 14:04
[Francis] 4284597
#19211070 11月前 2022-11-07 15:06
[Eve] 8*4，最后4行分成4*4


[Bob] 这个比前两个甚至更简单，不追求满分的话，随便划分一下，调一下块大小，很容易就能找出那种能拿9分以上的解。我当时第一遍写的时候没针对任何矩阵做优化，前两块分低的可怜，就60*68那个拿了8分
#11964231 1年前 2021-11-13 22:33
[Bob] 原理的话，这种不规则的其实降低了以最简单的分块的方式访问所产生的冲突不命中。像64*64那种每4行（我要是没搞错的话）必miss，我觉得优化反而更难
#11964425 1年前 2021-11-13 22:43
[洞主] 谢谢！我想到方法了！满分啦~谢谢大家！考虑下每个八字节的位置特点就好！